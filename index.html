<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BABA BANIYECHE SOMMAN KOR</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .bg-gradient-custom { background-image: linear-gradient(135deg,#e2e8f0 0%,#cbd5e1 100%);}
    .nav-btn.active { background:#3b82f6;color:#fff;}
    .nav-btn.inactive { background:#f1f5f9;color:#4b5563;}
    .btn-primary { background:#3b82f6;color:#fff;transition:.2s;}
    .btn-primary:hover { transform:translateY(-1px);box-shadow:0 4px 8px rgba(59,130,246,.3);}
    .chat-message { max-width:80%;padding:.75rem 1rem;border-radius:1.5rem;margin-bottom:1rem;}
    .user-message { background:#3b82f6;color:#fff;align-self:flex-end;border-bottom-right-radius:.5rem;}
    .ai-message { background:#f3f4f6;color:#111827;align-self:flex-start;border-bottom-left-radius:.5rem;}
    pre,code { background:#e2e8f0;border-radius:6px;padding:4px 6px;display:inline-block;overflow-x:auto;}
    table{border-collapse:collapse;width:100%;margin-top:10px;}
    th,td{border:1px solid #9ca3af;padding:6px 10px;text-align:left;}
    .loader{border:4px solid #e5e7eb;border-top:4px solid #3b82f6;border-radius:50%;width:24px;height:24px;animation:spin 1s linear infinite;}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
  </style>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4 bg-gradient-custom">
  <div id="main-app" class="bg-white rounded-3xl shadow-xl w-full max-w-4xl p-4 flex flex-col md:flex-row gap-6 overflow-hidden">
    <div class="md:w-1/4 flex flex-col gap-4 border-b md:border-b-0 md:border-r border-gray-200 pb-4 md:pb-0 md:pr-6">
      <h1 class="text-2xl font-bold text-gray-800 text-center md:text-left">BABA BANIYECHE SOMMAN KOR</h1>
      <nav class="flex md:flex-col gap-2 overflow-x-auto">
        <button class="nav-btn active font-medium py-3 px-4 rounded-full text-sm" data-view="chat">Chat</button>
        <button class="nav-btn inactive font-medium py-3 px-4 rounded-full text-sm" data-view="image">Image</button>
        <button class="nav-btn inactive font-medium py-3 px-4 rounded-full text-sm" data-view="file">File</button>
        <button class="nav-btn inactive font-medium py-3 px-4 rounded-full text-sm" data-view="code">Code</button>
      </nav>
    </div>

    <div class="md:w-3/4">
      <!-- CHAT -->
      <div id="chat-view" class="view flex flex-col h-full">
        <div id="chat-container" class="flex-1 overflow-y-auto p-4 bg-gray-50 rounded-2xl mb-4">
          <div class="chat-message ai-message">ðŸ‘‹ Hello! I'm your chat assistant.</div>
        </div>
        <div class="flex flex-col gap-2">
          <div class="flex gap-2">
            <button id="chat-new" class="btn-primary w-1/2 p-2 rounded-full font-bold text-sm">New Chat</button>
            <button id="chat-load" class="btn-primary w-1/2 p-2 rounded-full font-bold text-sm">Load Chat</button>
          </div>
          <div class="flex items-center gap-2">
            <input id="chat-input" class="flex-1 p-3 rounded-full border border-gray-300 focus:ring-2 focus:ring-blue-500" placeholder="Type your message...">
            <button id="chat-send" class="btn-primary p-3 rounded-full shadow-lg">Send</button>
          </div>
        </div>
      </div>

      <!-- IMAGE -->
      <div id="image-view" class="view hidden flex flex-col h-full">
        <div class="relative w-full h-72 bg-gray-200 rounded-2xl flex items-center justify-center mb-4">
          <div id="image-loader" class="loader hidden"></div>
          <img id="generated-image" src="https://placehold.co/600x400/e5e7eb/6b7280?text=Your+image+will+appear+here" class="w-full h-full object-cover rounded-2xl">
        </div>
        <div class="flex items-center gap-2">
          <input id="image-prompt" class="flex-1 p-3 rounded-full border border-gray-300 focus:ring-2 focus:ring-blue-500" placeholder="Describe your image...">
          <button id="image-generate" class="btn-primary p-3 rounded-full shadow-lg">Generate</button>
        </div>
      </div>

      <!-- FILE -->
      <div id="file-view" class="view hidden flex flex-col h-full">
        <div id="file-result" class="flex-1 overflow-y-auto p-4 bg-gray-50 rounded-2xl mb-4">
          <div class="bg-white p-4 rounded-xl shadow-sm text-gray-700">Upload a file to analyze.</div>
        </div>
        <div id="file-upload-input" class="flex items-center gap-2">
          <input type="file" id="file-input" class="flex-1 text-sm text-gray-500 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
          <button id="file-analyze" class="btn-primary p-3 rounded-full shadow-lg">Analyze</button>
        </div>
        <div id="file-chat" class="hidden mt-2 flex items-center gap-2">
          <input id="file-chat-prompt" class="flex-1 p-3 rounded-full border border-gray-300 focus:ring-2 focus:ring-blue-500" placeholder="Ask about the file...">
          <button id="file-chat-send" class="btn-primary p-3 rounded-full shadow-lg">Send</button>
        </div>
      </div>

      <!-- CODE -->
      <div id="code-view" class="view hidden flex flex-col h-full">
        <div id="code-output" class="flex-1 overflow-y-auto p-4 bg-gray-50 rounded-2xl mb-4 text-gray-800">
          <p>Type a prompt to generate, debug, or fix code.</p>
        </div>
        <div class="flex items-center gap-2">
          <textarea id="code-prompt" class="flex-1 p-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500" rows="3" placeholder="Describe your code problem..."></textarea>
          <button id="code-generate" class="btn-primary p-3 rounded-full shadow-lg">Generate</button>
        </div>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const API = "https://openrouter.ai/api/v1/chat/completions";
  const IMAGE_API = "https://openrouter.ai/api/v1/images/generations";
  const KEY = "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";

  const views=document.querySelectorAll('.view');
  const navBtns=document.querySelectorAll('.nav-btn');
  const showView=(id)=>{
    views.forEach(v=>v.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    navBtns.forEach(b=>{
      b.classList.toggle('active',`${b.dataset.view}-view`===id);
      b.classList.toggle('inactive',`${b.dataset.view}-view`!==id);
    });
  };
  navBtns.forEach(b=>b.onclick=()=>showView(`${b.dataset.view}-view`));

  const renderMarkdown=(txt)=>marked.parse(txt);

  // CHAT
  const chatC=document.getElementById('chat-container');
  const chatInput=document.getElementById('chat-input');
  const chatSend=document.getElementById('chat-send');
  const chatNew=document.getElementById('chat-new');
  const chatLoad=document.getElementById('chat-load');
  let chatHistory=[];

  async function chatSendMessage(){
    const msg=chatInput.value.trim();
    if(!msg)return;
    chatC.innerHTML+=`<div class='chat-message user-message'>${msg}</div>`;
    chatInput.value='';
    const loader=document.createElement('div');
    loader.className='chat-message ai-message';
    loader.innerHTML='<div class="loader"></div>';
    chatC.appendChild(loader);
    chatC.scrollTop=chatC.scrollHeight;
    const res=await fetch(API,{method:'POST',headers:{'Authorization':`Bearer ${KEY}`,'Content-Type':'application/json'},body:JSON.stringify({model:'openai/gpt-4o-mini',messages:[...chatHistory,{role:'user',content:msg}]})});
    const data=await res.json();
    const reply=data?.choices?.[0]?.message?.content||'Error.';
    loader.innerHTML=renderMarkdown(reply);
    chatHistory.push({role:'user',content:msg},{role:'assistant',content:reply});
    localStorage.setItem('chatHistory',JSON.stringify(chatHistory));
  }
  chatSend.onclick=chatSendMessage;
  chatInput.onkeydown=e=>{if(e.key==='Enter'){e.preventDefault();chatSendMessage();}};
  chatNew.onclick=()=>{chatHistory=[];localStorage.removeItem('chatHistory');chatC.innerHTML='<div class="chat-message ai-message">ðŸ†• New chat started.</div>';};
  chatLoad.onclick=()=>{const s=localStorage.getItem('chatHistory');if(s){chatHistory=JSON.parse(s);chatC.innerHTML=chatHistory.map(m=>`<div class='chat-message ${m.role==='user'?'user-message':'ai-message'}'>${renderMarkdown(m.content)}</div>`).join('');}else{chatC.innerHTML='<div class="chat-message ai-message">No saved chat.</div>';}};  

  // IMAGE
  const imgPrompt=document.getElementById('image-prompt');
  const imgGen=document.getElementById('image-generate');
  const imgOut=document.getElementById('generated-image');
  const imgLoad=document.getElementById('image-loader');
  imgGen.onclick=async()=>{
    const t=imgPrompt.value.trim();
    if(!t)return alert('Enter prompt');
    imgLoad.classList.remove('hidden');
    const res=await fetch(IMAGE_API,{method:'POST',headers:{'Authorization':`Bearer ${KEY}`,'Content-Type':'application/json'},body:JSON.stringify({model:'openai/dall-e-3',prompt:t,n:1,size:'1024x1024'})});
    const d=await res.json();
    imgOut.src=d?.data?.[0]?.url||'https://placehold.co/600x400?text=Failed';
    imgLoad.classList.add('hidden');
  };

  // FILE
  const fInput=document.getElementById('file-input');
  const fBtn=document.getElementById('file-analyze');
  const fRes=document.getElementById('file-result');
  const fChat=document.getElementById('file-chat');
  const fChatPrompt=document.getElementById('file-chat-prompt');
  const fChatSend=document.getElementById('file-chat-send');
  let fHist=[];
  fBtn.onclick=()=>{
    const f=fInput.files[0];if(!f)return alert('Select file');
    const r=new FileReader();
    r.onload=async()=>{
      const content=r.result.slice(0,4000);
      fRes.innerHTML='<div class="ai-message p-3">Analyzing file...</div>';
      const res=await fetch(API,{method:'POST',headers:{'Authorization':`Bearer ${KEY}`,'Content-Type':'application/json'},body:JSON.stringify({model:'openai/gpt-4o-mini',messages:[{role:'user',content:`Analyze this file:\n${content}`}]})});
      const d=await res.json();
      const rep=d?.choices?.[0]?.message?.content||'Error.';
      fRes.innerHTML=`<div class="ai-message p-3">${renderMarkdown(rep)}</div>`;
      fChat.classList.remove('hidden');fHist=[{role:'assistant',content:rep}];
    };r.readAsText(f);
  };
  fChatSend.onclick=async()=>{
    const q=fChatPrompt.value.trim();if(!q)return;
    fRes.innerHTML+=`<div class="chat-message user-message">${q}</div>`;
    const res=await fetch(API,{method:'POST',headers:{'Authorization':`Bearer ${KEY}`,'Content-Type':'application/json'},body:JSON.stringify({model:'openai/gpt-4o-mini',messages:[...fHist,{role:'user',content:q}]})});
    const d=await res.json();
    const rep=d?.choices?.[0]?.message?.content||'Error.';
    fRes.innerHTML+=`<div class="chat-message ai-message">${renderMarkdown(rep)}</div>`;
    fHist.push({role:'user',content:q},{role:'assistant',content:rep});
    fChatPrompt.value='';
  };

  // CODE
  const cPrompt=document.getElementById('code-prompt');
  const cBtn=document.getElementById('code-generate');
  const cOut=document.getElementById('code-output');
  cBtn.onclick=async()=>{
    const text=cPrompt.value.trim();if(!text)return alert('Enter code prompt');
    cOut.innerHTML='<div class="p-3">Generating code...</div>';
    const res=await fetch(API,{method:'POST',headers:{'Authorization':`Bearer ${KEY}`,'Content-Type':'application/json'},body:JSON.stringify({model:'openai/gpt-4o-mini',messages:[{role:'user',content:text}]})});
    const d=await res.json();
    const rep=d?.choices?.[0]?.message?.content||'Error.';
    cOut.innerHTML=renderMarkdown(rep);
  };
});
</script>
</body>
</html>